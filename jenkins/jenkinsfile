pipeline {
   agent {
    label 'devops'
   }
   options {
    buildDiscarder(logRotator(numToKeepStr: '7'))
    timeout(time: 1, unit: 'HOURS') 
   }
   parameters {
     string(name: 'Branchname', defaultValue: 'deployment')
   }
   environment {
     DOCKER_REPO_CREDS =  credentials('docker-registy-login')
   } 
  
   stages {
    stage("App Code Checkout") {
      steps {
        git branch: "${params.Branchname}", url: 'https://github.com/prateekkumawat/jenkins-mansi-project.git'
      }
    }
    
    stage("compose deployment") {
        sh " docker login -u  $DOCKER_REPO_CREDS_USR -p $DOCKER_REPO_CREDS_PSW "
        sh " docker-compose up -d "
    }


    